<!-- query details -->
$('div#query-details').html("<%= escape_javascript(raw render partial: "/query/details", layout: false) %>");

<!-- query results -->
<% unless @query.view == 4 %>
<% if @query.running? || @query.counting? %>
setTimeout(function(){
	$.getScript('/<%= @namespace %>/result/id/<%= @query.id %>.js');
}, 2000);
<% elsif @query.failed? %>
$('div#result-pane').html("<%= escape_javascript(raw render partial: "/layouts/messages", :locals => { :flash => { :error => "Failed to execute query" } }) %>");
<% else %>
$('div#result-pane').html("<%= escape_javascript(raw render partial: "/queries/result", layout: false, locals: { query: @query }) %>");
<% if @query.counting? %>
	$.getScript('/<%= @namespace %>/result/id/<%= @query.id %>.js');
<% else %>
	$.getScript('/<%= @namespace %>/result/id/<%= @query.id %>/pagination.js');
<% end %>
<% end %>
<% end %>