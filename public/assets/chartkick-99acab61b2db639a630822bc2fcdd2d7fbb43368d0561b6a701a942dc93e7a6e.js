!function(t){"use strict";function e(t){return"[object Array]"===Object.prototype.toString.call(t)}function n(t){return t instanceof Function}function i(t){return!n(t)&&t instanceof Object}function r(t,n){var a;for(a in n)i(n[a])||e(n[a])?(i(n[a])&&!i(t[a])&&(t[a]={}),e(n[a])&&!e(t[a])&&(t[a]=[]),r(t[a],n[a])):void 0!==n[a]&&(t[a]=n[a])}function a(t,e){var n={};return r(n,t),r(n,e),n}function o(t){var e,n,i,r,a,o,s,l,u,c,d;return c=Object.prototype.toString.call(t),"[object Date]"===c?t:"[object String]"===c?(i=t.match(B),i?(d=parseInt(i[1],10),o=parseInt(i[3],10)-1,e=parseInt(i[5],10),n=parseInt(i[7],10),a=i[9]?parseInt(i[9],10):0,u=i[11]?parseInt(i[11],10):0,r=i[12]?1e3*parseFloat(U+i[12].slice(1)):0,l=Date.UTC(d,o,e,n,a,u,r),i[13]&&i[14]&&(s=60*i[15],i[17]&&(s+=parseInt(i[17],10)),s*="-"===i[14]?-1:1,l-=60*s*1e3),new Date(l)):void 0):void 0}function s(t){var e,n,i;for(e=0;e<t.length;e++)for(i=t[e].data,n=0;n<i.length;n++)if(i[n][1]<0)return!0;return!1}function l(t,e,n,i,r,o,l){return function(u,c,d){var f=a({},t);return f=a(f,d||{}),c.hideLegend&&e(f),"min"in c?n(f,c.min):s(u)||n(f,0),c.max&&i(f,c.max),"stacked"in c&&r(f,c.stacked),c.colors&&(f.colors=c.colors),c.xtitle&&o(f,c.xtitle),c.ytitle&&l(f,c.ytitle),f=a(f,c.library||{})}}function u(t,e){document.body.innerText?t.innerText=e:t.textContent=e}function c(t,e){u(t,"Error Loading Chart: "+e),t.style.color="#ff0000"}function d(e,n,i){var r=t.jQuery||t.Zepto||t.$;r.ajax({dataType:"json",url:n,success:i,error:function(t,n,i){var r="string"==typeof i?i:i.message;c(e,r)}})}function f(t,e){try{e(t)}catch(n){throw c(t.element,n.message),n}}function h(t,e){"string"==typeof t.dataSource?d(t.element,t.dataSource,function(n){t.data=n,f(t,e)}):(t.data=t.dataSource,f(t,e))}function p(t){return""+t}function g(t){return parseFloat(t)}function v(t){var e,n,i,r;if("object"!=typeof t)if("number"==typeof t)t=new Date(1e3*t);else{if(e=t.match(Z))return n=parseInt(e[1],10),i=parseInt(e[3],10)-1,r=parseInt(e[5],10),new Date(n,i,r);var a=t.replace(/ /,"T").replace(" ","").replace("UTC","Z");t=o(a)||new Date(t)}return t}function m(t){if(!e(t)){var n,i=[];for(n in t)t.hasOwnProperty(n)&&i.push([n,t[n]]);t=i}return t}function y(t,e){return t[0].getTime()-e[0].getTime()}function b(t,e){return t-e}function x(){!Q&&"Highcharts"in t&&(Q=new function(){var e=t.Highcharts;this.name="highcharts";var n={chart:{},xAxis:{title:{text:null},labels:{style:{fontSize:"12px"}}},yAxis:{title:{text:null},labels:{style:{fontSize:"12px"}}},title:{text:null},credits:{enabled:!1},legend:{borderWidth:0},tooltip:{style:{fontSize:"12px"}},plotOptions:{areaspline:{},series:{marker:{}}}},i=function(t){t.legend.enabled=!1},r=function(t,e){t.yAxis.min=e},o=function(t,e){t.yAxis.max=e},s=function(t,e){t.plotOptions.series.stacking=e?"normal":null},u=function(t,e){t.xAxis.title.text=e},c=function(t,e){t.yAxis.title.text=e},d=l(n,i,r,o,s,u,c);this.renderLineChart=function(t,n){n=n||"spline";var i={};"areaspline"===n&&(i={plotOptions:{areaspline:{stacking:"normal"},series:{marker:{enabled:!1}}}});var r,a,o,s=d(t.data,t.options,i);s.xAxis.type=t.options.discrete?"category":"datetime",s.chart.type=n,s.chart.renderTo=t.element.id;var l=t.data;for(a=0;a<l.length;a++){if(r=l[a].data,!t.options.discrete)for(o=0;o<r.length;o++)r[o][0]=r[o][0].getTime();l[a].marker={symbol:"circle"}}s.series=l,new e.Chart(s)},this.renderScatterChart=function(t){var n={},i=d(t.data,t.options,n);i.chart.type="scatter",i.chart.renderTo=t.element.id,i.series=t.data,new e.Chart(i)},this.renderPieChart=function(t){var i={};t.options.colors&&(i.colors=t.options.colors);var r=a(a(n,i),t.options.library||{});r.chart.renderTo=t.element.id,r.series=[{type:"pie",name:t.options.label||"Value",data:t.data}],new e.Chart(r)},this.renderColumnChart=function(t,n){n=n||"column";var i,r,a,o,s=t.data,l=d(s,t.options),u=[];for(l.chart.type=n,l.chart.renderTo=t.element.id,i=0;i<s.length;i++)for(a=s[i],r=0;r<a.data.length;r++)o=a.data[r],u[o[0]]||(u[o[0]]=new Array(s.length)),u[o[0]][i]=o[1];var c=[];for(i in u)u.hasOwnProperty(i)&&c.push(i);l.xAxis.categories=c;var f=[];for(i=0;i<s.length;i++){for(o=[],r=0;r<c.length;r++)o.push(u[c[r]][i]||0);f.push({name:s[i].name,data:o})}l.series=f,new e.Chart(l)};var f=this;this.renderBarChart=function(t){f.renderColumnChart(t,"bar")},this.renderAreaChart=function(t){f.renderLineChart(t,"areaspline")}},Y.push(Q)),!G&&t.google&&t.google.setOnLoadCallback&&(G=new function(){var e=t.google;this.name="google";var n={},i=[],r=function(){for(var t,n,r=0;r<i.length;r++)t=i[r],n=e.visualization&&("corechart"===t.pack&&e.visualization.LineChart||"timeline"===t.pack&&e.visualization.Timeline),n&&(t.callback(),i.splice(r,1),r--)},o=function(t,a){if(a||(a=t,t="corechart"),i.push({pack:t,callback:a}),n[t])r();else{n[t]=!0;var o={packages:[t],callback:r};X.language&&(o.language=X.language),e.load("visualization","1",o)}},s={chartArea:{},fontName:"'Lucida Grande', 'Lucida Sans Unicode', Verdana, Arial, Helvetica, sans-serif",pointSize:6,legend:{textStyle:{fontSize:12,color:"#444"},alignment:"center",position:"right"},curveType:"function",hAxis:{textStyle:{color:"#666",fontSize:12},titleTextStyle:{},gridlines:{color:"transparent"},baselineColor:"#ccc",viewWindow:{}},vAxis:{textStyle:{color:"#666",fontSize:12},titleTextStyle:{},baselineColor:"#ccc",viewWindow:{}},tooltip:{textStyle:{color:"#666",fontSize:12}}},u=function(t){t.legend.position="none"},c=function(t,e){t.vAxis.viewWindow.min=e},d=function(t,e){t.vAxis.viewWindow.max=e},f=function(t,e){t.hAxis.viewWindow.min=e},h=function(t,e){t.hAxis.viewWindow.max=e},p=function(t,e){t.isStacked=!!e},v=function(t,e){t.hAxis.title=e,t.hAxis.titleTextStyle.italic=!1},m=function(t,e){t.vAxis.title=e,t.vAxis.titleTextStyle.italic=!1},b=l(s,u,c,d,p,v,m),x=function(t,n){var i,r,a,o,s,l=[];for(i=0;i<t.length;i++)for(a=t[i],r=0;r<a.data.length;r++)o=a.data[r],s="datetime"===n?o[0].getTime():o[0],l[s]||(l[s]=new Array(t.length)),l[s][i]=g(o[1]);var u,c=[],d=!0;for(i in l)l.hasOwnProperty(i)&&("datetime"===n?(u=new Date(g(i)),d=d&&k(u)):u="number"===n?g(i):i,c.push([u].concat(l[i])));"datetime"===n&&c.sort(y);var f=new e.visualization.DataTable;for(n="datetime"===n&&d?"date":n,f.addColumn(n,""),i=0;i<t.length;i++)f.addColumn("number",t[i].name);return f.addRows(c),f},w=function(e){t.attachEvent?t.attachEvent("onresize",e):t.addEventListener&&t.addEventListener("resize",e,!0),e()};this.renderLineChart=function(t){o(function(){var n=b(t.data,t.options),i=x(t.data,t.options.discrete?"string":"datetime");t.chart=new e.visualization.LineChart(t.element),w(function(){t.chart.draw(i,n)})})},this.renderPieChart=function(t){o(function(){var n={chartArea:{top:"10%",height:"80%"}};t.options.colors&&(n.colors=t.options.colors);var i=a(a(s,n),t.options.library||{}),r=new e.visualization.DataTable;r.addColumn("string",""),r.addColumn("number","Value"),r.addRows(t.data),t.chart=new e.visualization.PieChart(t.element),w(function(){t.chart.draw(r,i)})})},this.renderColumnChart=function(t){o(function(){var n=b(t.data,t.options),i=x(t.data,"string");t.chart=new e.visualization.ColumnChart(t.element),w(function(){t.chart.draw(i,n)})})},this.renderBarChart=function(t){o(function(){var n={hAxis:{gridlines:{color:"#ccc"}}},i=l(s,u,f,h,p)(t.data,t.options,n),r=x(t.data,"string");t.chart=new e.visualization.BarChart(t.element),w(function(){t.chart.draw(r,i)})})},this.renderAreaChart=function(t){o(function(){var n={isStacked:!0,pointSize:0,areaOpacity:.5},i=b(t.data,t.options,n),r=x(t.data,t.options.discrete?"string":"datetime");t.chart=new e.visualization.AreaChart(t.element),w(function(){t.chart.draw(r,i)})})},this.renderGeoChart=function(t){o(function(){var n={legend:"none",colorAxis:{colors:t.options.colors||["#f6c7b6","#ce502d"]}},i=a(a(s,n),t.options.library||{}),r=new e.visualization.DataTable;r.addColumn("string",""),r.addColumn("number",t.options.label||"Value"),r.addRows(t.data),t.chart=new e.visualization.GeoChart(t.element),w(function(){t.chart.draw(r,i)})})},this.renderScatterChart=function(t){o(function(){var n={},i=b(t.data,t.options,n),r=x(t.data,"number");t.chart=new e.visualization.ScatterChart(t.element),w(function(){t.chart.draw(r,i)})})},this.renderTimeline=function(t){o("timeline",function(){var n={legend:"none"};t.options.colors&&(n.colors=t.options.colors);var i=a(a(s,n),t.options.library||{}),r=new e.visualization.DataTable;r.addColumn({type:"string",id:"Name"}),r.addColumn({type:"date",id:"Start"}),r.addColumn({type:"date",id:"End"}),r.addRows(t.data),t.element.style.lineHeight="normal",t.chart=new e.visualization.Timeline(t.element),w(function(){t.chart.draw(r,i)})})}},Y.push(G)),!V&&"Chart"in t&&(V=new function(){var e=t.Chart;this.name="chartjs";var n={maintainAspectRatio:!1,animation:!1},i={scales:{yAxes:[{ticks:{maxTicksLimit:4},scaleLabel:{fontSize:16,fontColor:"#333"}}],xAxes:[{gridLines:{drawOnChartArea:!1},scaleLabel:{fontSize:16,fontColor:"#333"},time:{},ticks:{}}]},legend:{}},r=["#3366CC","#DC3912","#FF9900","#109618","#990099","#3B3EAC","#0099C6","#DD4477","#66AA00","#B82E2E","#316395","#994499","#22AA99","#AAAA11","#6633CC","#E67300","#8B0707","#329262","#5574A6","#3B3EAC"],o=function(t){t.legend.display=!1},s=function(t,e){null!==e&&(t.scales.yAxes[0].ticks.min=e)},u=function(t,e){t.scales.yAxes[0].ticks.max=e},c=function(t,e){null!==e&&(t.scales.xAxes[0].ticks.min=e)},d=function(t,e){t.scales.xAxes[0].ticks.max=e},f=function(t,e){t.scales.xAxes[0].stacked=!!e,t.scales.yAxes[0].stacked=!!e},h=function(t,e){t.scales.xAxes[0].scaleLabel.display=!0,t.scales.xAxes[0].scaleLabel.labelString=e},v=function(t,e){t.scales.yAxes[0].scaleLabel.display=!0,t.scales.yAxes[0].scaleLabel.labelString=e},m=function(t,n,i,r){t.element.innerHTML="<canvas></canvas>";var a=t.element.getElementsByTagName("CANVAS")[0];t.chart=new e(a,{type:n,data:i,options:r})},y=function(t,e){var n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return n?"rgba("+parseInt(n[1],16)+", "+parseInt(n[2],16)+", "+parseInt(n[3],16)+", "+e+")":t},x=function(t,e,n){var i=Math.ceil(t.element.offsetWidth/4/e.labels.length);n.scales.xAxes[0].ticks.callback=function(t){return t=p(t),t.length>i?t.substring(0,i-2)+"...":t}},w=l(a(n,i),o,s,u,f,h,v),M=function(t,e,n){var i,o,s,l,u,c,d=[],f=[],h=t.options.colors||r,p=!0,v=!0,m=!0,x=!0,w=!0,M=!0,E=("line"===n||"area"===n)&&!t.options.discrete,N=t.data,A=[],W=[];for(o=0;o<N.length;o++)for(l=N[o],s=0;s<l.data.length;s++)u=l.data[s],c=E?u[0].getTime():u[0],W[c]||(W[c]=new Array(N.length)),W[c][o]=g(u[1]),-1===A.indexOf(c)&&A.push(c);E&&A.sort(b);var j=[];for(s=0;s<N.length;s++)j.push([]);var q,D;for(D=0;D<A.length;D++)for(o=A[D],E?(q=new Date(g(o)),p=p&&k(q),i||(i=q.getDay()),v=v&&_(q,i),m=m&&S(q),x=x&&T(q),w=w&&$(q),M=M&&C(q)):q=o,f.push(q),s=0;s<N.length;s++)j[s].push(W[o][s]);for(o=0;o<N.length;o++){l=N[o];var L="line"!==n?y(h[o],.5):h[o],P={label:l.name,data:j[o],fill:"area"===n,borderColor:h[o],backgroundColor:L,pointBackgroundColor:h[o],borderWidth:2};d.push(a(P,l.library||{}))}if(E&&f.length>0){var O=f[0].getTime(),I=f[0].getTime();for(o=1;o<f.length;o++)q=f[o].getTime(),O>q&&(O=q),q>I&&(I=q);var F=(I-O)/864e5;if(!e.scales.xAxes[0].time.unit){var z;if(x||F>3650?(e.scales.xAxes[0].time.unit="year",z=365):m||F>300?(e.scales.xAxes[0].time.unit="month",z=30):p||F>10?(e.scales.xAxes[0].time.unit="day",z=1):w?(e.scales.xAxes[0].time.unit="hour",z=1/24):M&&(e.scales.xAxes[0].time.displayFormats={minute:"h:mm a"},e.scales.xAxes[0].time.unit="minute",z=1/24/60),z&&F>0){var R=Math.ceil(F/z/(t.element.offsetWidth/100));v&&(R=7*Math.ceil(R/7)),e.scales.xAxes[0].time.unitStepSize=R}}e.scales.xAxes[0].time.tooltipFormat||(p?e.scales.xAxes[0].time.tooltipFormat="ll":w?e.scales.xAxes[0].time.tooltipFormat="MMM D, h a":M&&(e.scales.xAxes[0].time.tooltipFormat="h:mm a"))}var H={labels:f,datasets:d};return H};this.renderLineChart=function(t,e){var n={};!t.options.max&&E(t.data)&&(t.options.max=1);var i=w(t.data,a(n,t.options)),r=M(t,i,e||"line");i.scales.xAxes[0].type=t.options.discrete?"category":"time",m(t,"line",r,i)},this.renderPieChart=function(t){for(var e=a(n,t.options.library||{}),i=[],o=[],s=0;s<t.data.length;s++){var l=t.data[s];i.push(l[0]),o.push(l[1])}var u={labels:i,datasets:[{data:o,backgroundColor:t.options.colors||r}]};m(t,"pie",u,e)},this.renderColumnChart=function(t,e){var r;r="bar"===e?l(a(n,i),o,c,d,f)(t.data,t.options):w(t.data,t.options);var s=M(t,r,"column");x(t,s,r),m(t,"bar"===e?"horizontalBar":"bar",s,r)};var N=this;this.renderAreaChart=function(t){N.renderLineChart(t,"area")},this.renderBarChart=function(t){N.renderColumnChart(t,"bar")}},Y.unshift(V))}function w(t,e){var i,r,a,o;for(a="render"+t,o=e.options.adapter,x(),i=0;i<Y.length;i++)if(r=Y[i],(!o||o===r.name)&&n(r[a]))return r[a](e);throw new Error("No adapter found")}function C(t){return 0===t.getMilliseconds()&&0===t.getSeconds()}function $(t){return C(t)&&0===t.getMinutes()}function k(t){return $(t)&&0===t.getHours()}function _(t,e){return k(t)&&t.getDay()===e}function S(t){return k(t)&&1===t.getDate()}function T(t){return S(t)&&0===t.getMonth()}function M(t){return!isNaN(v(t))&&p(t).length>=6}function E(t){var e,n,i;for(e=0;e<t.length;e++)for(i=t[e].data,n=0;n<i.length;n++)if(0!=i[n][1])return!1;return!0}function N(t){var e,n,i;for(e=0;e<t.length;e++)for(i=m(t[e].data),n=0;n<i.length;n++)if(!M(i[n][0]))return!0;return!1}function A(t,n,i){var r;for(!e(t)||"object"!=typeof t[0]||e(t[0])?(t=[{name:n.label||"Value",data:t}],n.hideLegend=!0):n.hideLegend=!1,null!==n.discrete&&void 0!==n.discrete||(n.discrete=N(t)),n.discrete&&(i="string"),r=0;r<t.length;r++)t[r].data=K(m(t[r].data),i);return t}function W(t){var e,n=m(t);for(e=0;e<n.length;e++)n[e]=[p(n[e][0]),g(n[e][1])];return n}function j(t){var e;for(e=0;e<t.length;e++)t[e][1]=v(t[e][1]),t[e][2]=v(t[e][2]);return t}function q(t){t.data=A(t.data,t.options,"datetime"),w("LineChart",t)}function D(t){t.data=A(t.data,t.options,"string"),w("ColumnChart",t)}function L(t){t.data=W(t.data),w("PieChart",t)}function P(t){t.data=A(t.data,t.options,"string"),w("BarChart",t)}function O(t){t.data=A(t.data,t.options,"datetime"),w("AreaChart",t)}function I(t){t.data=W(t.data),w("GeoChart",t)}function F(t){t.data=A(t.data,t.options,"number"),w("ScatterChart",t)}function z(t){t.data=j(t.data),w("Timeline",t)}function R(t,e,n,i,r){"string"==typeof e&&(e=document.getElementById(e)),t.element=e,t.options=i||{},t.dataSource=n,t.getElement=function(){return e},t.getData=function(){return t.data},t.getOptions=function(){return i||{}},t.getChartObject=function(){return t.chart},H.charts[e.id]=t,h(t,r)}var H,B,U,G,Q,V,X=t.Chartkick||{},Y=[],Z=/^(\d\d\d\d)(\-)?(\d\d)(\-)?(\d\d)$/i;B=/(\d\d\d\d)(\-)?(\d\d)(\-)?(\d\d)(T)?(\d\d)(:)?(\d\d)?(:)?(\d\d)?([\.,]\d+)?($|Z|([\+\-])(\d\d)(:)?(\d\d)?)/i,U=String(1.5).charAt(1);var J=function(t,e){return t="number"===e?g(t):"datetime"===e?v(t):p(t)},K=function(t,e){var n,i,r=[];for(i=0;i<t.length;i++)n=J(t[i][0],e),r.push([n,g(t[i][1])]);return"datetime"===e&&r.sort(y),r};H={LineChart:function(t,e,n){R(this,t,e,n,q)},PieChart:function(t,e,n){R(this,t,e,n,L)},ColumnChart:function(t,e,n){R(this,t,e,n,D)},BarChart:function(t,e,n){R(this,t,e,n,P)},AreaChart:function(t,e,n){R(this,t,e,n,O)},GeoChart:function(t,e,n){R(this,t,e,n,I)},ScatterChart:function(t,e,n){R(this,t,e,n,F)},Timeline:function(t,e,n){R(this,t,e,n,z)},charts:{}},"object"==typeof module&&"object"==typeof module.exports?module.exports=H:t.Chartkick=H}(window);